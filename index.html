<!DOCTYPE html>

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <style>
        #imageToGuess {
            display: none;
            height: 300px;
        }

        * {
            margin-bottom: 20px;
        }
    </style>
    <script>

        let breedNamesList = []
        let breedToGuess;
        let imageToGuess;
        let gameStarted = false
        let isGuessing = false
        let score = 0

        window.onload = init()

        async function init() {
            const breedsResponse = await fetch('https://dog.ceo/api/breeds/list/all')
            breedsJson = await breedsResponse.json()
            breedNamesList = Object.keys(breedsJson.message)
        }

        function getRandomBreedName() {
            var breedName = breedNamesList[Math.floor(Math.random() * breedNamesList.length)];
            return breedName
        }

        async function getRandomImageByBreed(breed) {
            const imagesResponse = await fetch(`https://dog.ceo/api/breed/${breed}/images/random`)
            const imagesJson = await imagesResponse.json()
            const imagePath = imagesJson.message
            console.log(imagePath)
            return imagePath
        }

        async function loadNewDog() {
            breedToGuess = await getRandomBreedName().trim()
            imageToGuess = await getRandomImageByBreed(breedToGuess)
            document.getElementById('imageToGuess').src = imageToGuess
        }

        async function startGame() {
            score = 0
            document.getElementById('score').innerText = score
            gameStarted = true
            await loadNewDog()
            document.getElementById("imageToGuess").style.display = 'inline'
        }
    

        async function guessBreed() {
            const currentBreedGuess = document.getElementById('guessDogBreedInput').value.trim().toLowerCase()
            if (currentBreedGuess === breedToGuess) {
                document.getElementById('helperText').innerText = ''
                score++
                document.getElementById('score').innerText = score
                await loadNewDog()
            }
            else if (currentBreedGuess.includes(breedToGuess) || breedToGuess.includes(currentBreedGuess)){
                document.getElementById('helperText').innerText = 'You are warm, keep guessing!'
            }
            else {
                document.getElementById('helperText').innerText = 'Cold, try again!'
            }
        }
    </script>
</head>

<body>
    <div class="container">
        Score: <p id="score">0</p>
        <img id="imageToGuess" src="" alt="dog image goes here" class="img-fluid"/>
        <p id="helperText"></p>
        <input id="guessDogBreedInput" placeholder="Guess dog breed and click guess button" class="form-control"/>
        <button type="button" class="btn btn-primary" onclick="guessBreed()">Guess</button>
        <button type="button" class="btn btn-primary" onclick="startGame()">Start</button>
    </div>
</body>

</html>